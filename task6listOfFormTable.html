<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>List of Forms</title>
    <link rel="stylesheet" href="task6listofForms.css"></link>
</head>
<body>
    <div style="display: flex;justify-content: center;">
        <button type="button" onclick="window.location.href='task6listOfControlarForm.html'">Add</button>
    </div>
    <h2>List of Forms Table</h2>
    <table border="1px solid" style='border-collapse: collapse;'>
        <thead>
            <tr>
                <th>Quantity.No</th>
                <th>Form Name</th>
                <th colspan="3">Action</th>
            </tr>
        </thead>
        <tbody id="formBodyData">
        </tbody>
    </table>
    <!-- <script>
        let fetchStoredData = JSON.parse(localStorage.getItem('formsData')) || [];
        let formBodyData = document.getElementById('formBodyData');

        let renderFormBodyData = () => {
            formBodyData.innerHTML = '';
            fetchStoredData.forEach((ele, ind) => {
                let row = document.createElement('tr');
                row.innerHTML = `
                <th>${ind+1}.</th>
                <td>${ele.FormName}</td>
                <td><button onclick="viewForm(${ind})">View</button></td>
                <td><button onclick="editForm(${ind})">Edit</button></td>
                <td><button onclick="deleteForm(${ind})">Delete</button></td>
                `;
                formBodyData.appendChild(row);
            });
        };

        let viewForm = (index) => {
            let singleViewData = fetchStoredData.filter((ele, i) => i == index);
            if(singleViewData){
                localStorage.setItem('viewFormData', JSON.stringify(singleViewData));
                window.location.href = `task6listOfFormView.html?viewIndex=${index}`;
            }
            alert("Viewing form at index: " + index);
        };

        let editForm = (index) => {
            let singleData = fetchStoredData.find((ele, i) => i == index);
            
            if (singleData) {
                localStorage.setItem('editFormData', JSON.stringify(singleData));
                //window.location.href = `task6listOfControlTypeTable.html?editIndex=${index}`;
                window.location.href = `task6listOfControlTypeTable.html?editIndexx=${index}`;
            }
        };

        let deleteForm = (index) => {
            let fetdata=fetchStoredData.index
            console.log("fetdata",fetdata)
            if (confirm("Are you sure you want to delete this form?")) {
                fetchStoredData.splice(index, 1);
                localStorage.setItem('formsData', JSON.stringify(fetchStoredData));
                renderFormBodyData();
            }
            

            let fetchstoredDataControls = JSON.parse(localStorage.getItem('controlsData')) || [];
    console.log("editIndexElement1",editIndexElement)
    console.log(index, "index");
    if(fetchStoredData.index){

    }
        if (index !== undefined && index !== null) {
            for (let i = 0; i < fetchstoredDataControls.length; i++) {
                let form = fetchstoredDataControls[i];
                for (let j = 0; j < form.Controls.length; j++) {
                    let control = form.Controls[j];
                    if (control.Id == index) {
                        form.Controls.splice(j, 1); 
                        if (form.Controls.length === 0) {
                            fetchstoredDataControls.splice(i, 1); 
                        }
                        localStorage.setItem('controlsData', JSON.stringify(fetchstoredDataControls));
                        renderFormBodyData();
                        window.location.href = `task6listOfControlTypeTable.html`
                    }
                }
            }
        } else {
            console.error("Invalid index provided for deletion.");
        }
    
        };

        renderFormBodyData();
    </script> -->

    <script>
  let fetchstoredDataControls = JSON.parse(localStorage.getItem('controlsData')) || [];

let editIndexElement = JSON.parse(localStorage.getItem('editFormData')) || [];

console.log("fetchstoredDataControls", fetchstoredDataControls);

let formBodyData = document.getElementById('formBodyData');

let renderFormBodyData = () => {
    formBodyData.innerHTML = '';
    fetchstoredDataControls.forEach((form, ind) => {
        console.log("form",form)
        let row = document.createElement('tr');
        row.style.margin = '20px';
        row.style.padding = '10px';
        
        
        let controls = form.Controls;

       
        controls.forEach((control, controlInd) => {
            let controlRow = document.createElement('tr');
            row.innerHTML = `
                <th>${controlInd + 1}</th>
                <td>${form.FormName || ''}</td>
                <td><button onclick="viewForm(${ind})">View</button></td>
                <td><button onclick="editForm(${ind})">Edit</button></td>
                <td><button onclick="deleteForm(${ind})">Delete</button></td>   
               
            `;
            formBodyData.appendChild(row);
        });
    });
};

let viewForm = (index) => {
            let singleViewData = fetchstoredDataControls.filter((ele, i) => i == index);
            if(singleViewData){
                localStorage.setItem('viewFormData', JSON.stringify(singleViewData));
                window.location.href = `task6listOfFormView.html?viewIndex=${index}`;
            }
            alert("Viewing form at index: " + index);
        };
let editForm = (index) => {
    console.log(index, 'indexedit');
            let singleData = fetchstoredDataControls.find((ele, i) => i == index);
            
            if (singleData) {
                localStorage.setItem('editFormData', JSON.stringify(singleData));
                //window.location.href = `task6listOfControlTypeTable.html?editIndex=${index}`;
                window.location.href = `task6listOfControlTypeTable.html?editIndex=${index}`;
            }
        };
        let deleteForm = (index) => {
            let fetdata=fetchstoredDataControls.index
            console.log("fetdata",fetdata,index)
            if (confirm("Are you sure you want to delete this form?")) {
                fetchstoredDataControls.splice(index, 1);
                localStorage.setItem('controlsData', JSON.stringify(fetchstoredDataControls));
                renderFormBodyData();
            }
        }





renderFormBodyData();      
    </script>
</body>
</html>
